<main>
	<div class="hero">
		<h1 class="hero__big-text">{{'contact.hero.title' | translate}}</h1>
		<p class="hero__small-text">
			{{'contact.hero.subtitle' | translate}}
		</p>
	</div> <!-- .hero -->

    <section class="contact">
        <!-- RIGHT SIDE -->
        <!-- Contact Form -->
        <div class="box contact__form-group">
            <h1>{{'contact.form.title' | translate}}</h1>
            <p class="form-group__subtitle">
                {{'contact.form.subtitle' | translate}}
            </p>
            
            <!-- Name -->
             <div class="form-group__form">
                <label>{{'contact.form.name.label' | translate}}</label>
                <input type="text" 
                [(ngModel)]="form.name"
                [placeholder]="'contact.form.name.placeholder' | translate">
             </div>
            
            <!-- Email Address -->
             <div class="form-group__form">
                <label>{{'contact.form.email.label' | translate}}</label>
                <input type="text"  
                [(ngModel)]="form.email"
                [placeholder]="'contact.form.email.placeholder' | translate">
             </div>
            
            <!-- Phone Number -->
             <div class="form-group__form">
                <label>{{'contact.form.phone.label' | translate}}</label>
                <input type="text" 
                [(ngModel)]="form.phone"
                [placeholder]="'contact.form.phone.placeholder' | translate">
             </div>

             
            <!-- Commission Details Field -->
            <div class="form-group__form" style="position: relative;">
                <label>{{'contact.commission.label' | translate}}</label>
                
                <div class="commission-field" 
                    [class.commission-field--active]="isCommissionRequest()">
                    
                    @if (isCommissionRequest()) {
                        <!-- The Pill -->
                        <div class="commission-pill" (click)="toggleCommissionDetails()">
                            <span class="commission-pill__icon">ðŸ“‹</span>
                            <span class="commission-pill__text">{{'contact.commission.pill' | translate}}</span>
                            <span class="commission-pill__price">${{ estimatedPrice() }}</span>
                        </div>

                        <!-- Image Badge (if image attached) -->
                        @if (selectedImage()) {
                            <div class="commission-image">
                                <img [src]="imagePreview()" 
                                    alt="Preview" 
                                    class="commission-image__preview">
                                <div class="commission-image__badge">
                                    <span>âœ“</span>
                                    <span>{{'contact.commission.image.attached' | translate}}</span>
                                </div>
                            </div>
                        }
                    }
                </div>

                <!-- Expandable Details -->
                @if (isCommissionRequest()) {
                    <div class="commission-details" 
                        [class.commission-details--visible]="showCommissionDetails()">
                        <h3 class="commission-details__title">{{'contact.commission.config' | translate}}</h3>
                        <div class="commission-details__grid">
                            <!-- Size -->
                            <div class="commission-details__item">
                                <span class="commission-details__label">{{'contact.commission.size' | translate}}:</span>
                                <span class="commission-details__value">{{ commissionConfig()?.size }}</span>
                            </div>
                            <!-- Frame -->
                            <div class="commission-details__item">
                                <span class="commission-details__label">{{'contact.commission.frame' | translate}}:</span>
                                <span class="commission-details__value">{{ commissionConfig()?.frame }}</span>
                            </div>
                            <!-- Stone Coverage -->
                            <div class="commission-details__item">
                                <span class="commission-details__label">{{'contact.commission.stones' | translate}}:</span>
                                <span class="commission-details__value">{{ commissionConfig()?.stoneCoverage }}</span>
                            </div>
                            <!-- Features -->
                             @if(commissionConfig()?.features.length ?? 0 > 0)
                             {
                                <div class="commission-details__item">
                                    <span class="commission-details__label">{{'contact.commission.features' | translate}}:</span>
                                    <span class="commission-details__value">{{ commissionConfig()?.features }}</span>
                                </div>
                             }
                            <!-- Treatments -->
                             @if (commissionConfig()?.treatments.length ?? 0 > 0) 
                             {
                                    <div class="commission-details__item">
                                    <span class="commission-details__label">{{'contact.commission.treatments' | translate}}:</span>
                                    <span class="commission-details__value">{{ commissionConfig()?.treatments }}</span>
                                </div>
                             }
                            
                            <!-- Shipping -->
                            <div class="commission-details__item">
                                <span class="commission-details__label">{{'contact.commission.shipping' | translate}}:</span>
                                <span class="commission-details__value">{{ commissionConfig()?.shipping }}</span>
                            </div>
                            <!-- Total Price -->
                            <div class="commission-details__item commission-details__item--total">
                                <span class="commission-details__label">{{'contact.commission.total' | translate}}:</span>
                                <span class="commission-details__value">${{ estimatedPrice() }}</span>
                            </div>
                        </div>

                        <!-- File Upload Button (inside expanded details) -->
                        <input type="file" 
                            accept="image/*" 
                            (change)="onImageSelected($event)"
                            #fileInput
                            style="display: none;">
                        
                        @if (!selectedImage()) {
                            <button type="button" 
                                    class="upload-button"
                                    (click)="fileInput.click()">
                                ðŸ“· {{'contact.commission.image.upload' | translate}}
                            </button>
                        } @else {
                            <button type="button" 
                                    class="remove-button"
                                    (click)="RemoveImage()">
                                âœ• {{'contact.commission.image.remove' | translate}}
                            </button>
                        }
                    </div>
                }
            </div>
            
            <!-- Inquiry Type -->
             <div class="form-group__form">
                <label>{{'contact.form.inquiry.label' | translate}}</label>
                <select 
                [(ngModel)]="form.inquiryType">
                    <option value="commission">{{'contact.form.inquiry.options.commission' | translate}}</option>
                    <option value="purchase">{{'contact.form.inquiry.options.purchase' | translate}}</option>
                    <option value="shipping">{{'contact.form.inquiry.options.shipping' | translate}}</option>
                    <option value="general">{{'contact.form.inquiry.options.general' | translate}}</option>
                </select>
             </div>
            
            <!-- Message -->
             <div class="form-group__form">
                <label>{{'contact.form.message.label' | translate}}</label>
                <textarea 
                [(ngModel)]="form.message"
                [placeholder]="'contact.form.message.placeholder' | translate"></textarea>
             </div>

             <!-- Post Scriptum -->
              <p class="ps">
                {{'contact.form.ps' | translate}}
              </p>

              <!-- Button -->
              <button 
              (click)="submitForm()"
              [disabled]="isSubmitting()"
              class="send-button">
                @if(isSubmitting())
                {
                  {{'contact.form.sending' | translate}}
                }
                @else
                {
                  {{'contact.form.button' | translate}}
                }
              </button>
        </div>

        <!-- LEFT SIDE -->
        <div class="contact__information">
            <!-- Direct Contact -->
            <div class="box information__container">
                <h2>{{'contact.info.direct.title' | translate}}</h2>
                
                <div class="container__spacing">
                    <h4 class="container__label">{{'contact.info.direct.email.label' | translate}}</h4>
                    <a class="container__text container__text--email"
                        href="mailto:{{contactService.getEmail()}}">
                        {{contactService.getEmail()}}
                    </a>
                </div>
                
                <div class="container__spacing">
                    <h4 class="container__label">{{'contact.info.direct.response.label' | translate}}</h4>
                    <h4 class="container__text">
                        {{'contact.info.direct.response.value' | translate}}
                    </h4>
                </div>
            </div>
            
            <!-- Location And Service -->
            <div class="box information__container">
                <h2>{{'contact.info.location.title' | translate}}</h2>
                
                <div class="container__spacing">
                    <h4 class="container__label">{{'contact.info.location.based.label' | translate}}</h4>
                    <h4 class="container__text">
                        {{'contact.info.location.based.value' | translate}}
                    </h4>
                </div>
                
                <div class="container__spacing">
                    <h4 class="container__label">{{'contact.info.location.shipping.label' | translate}}</h4>
                    <h4 class="container__text">
                        {{'contact.info.location.shipping.value' | translate}}
                    </h4>
                </div>
            </div>
            
            <!-- Business Hours -->
            <div class="box information__container">
                <h2>{{'contact.info.hours.title' | translate}}</h2>
                
                <div class="container__spacing">
                    <h4 class="container__label">{{'contact.info.hours.weekday.label' | translate}}</h4>
                    <h4 class="container__text">
                        {{'contact.info.hours.weekday.value' | translate}}
                    </h4>
                </div>
                
                <div class="container__spacing">
                    <h4 class="container__label">{{'contact.info.hours.saturday.label' | translate}}</h4>
                    <h4 class="container__text">
                        {{'contact.info.hours.saturday.value' | translate}}
                    </h4>
                </div>
            </div>
        </div>
    </section>
</main>

<!-- Success Modal -->
 @if (submitSuccess()) 
 {
    <div class="modal-overlay" 
        [class.modal-overlay--visible]="submitSuccess()"
        (click)="closeModals()">
        <div class="modal modal--success" (click)="$event.stopPropagation()">
            <div class="modal__icon">âœ“</div>
            <h2 class="modal__title">{{'contact.success.title' | translate}}</h2>
            <p class="modal__message">
                {{'contact.success.message' | translate}}
            </p>
            <button class="modal__button" (click)="closeModals()">
                {{'contact.success.button' | translate}}
            </button>
        </div>
    </div>
 }

<!-- Error Modal -->
 @if (submitError()) 
 {
    <div class="modal-overlay" 
        [class.modal-overlay--visible]="submitError()"
        (click)="closeModals()">
        <div class="modal modal--error" (click)="$event.stopPropagation()">
            <div class="modal__icon">âœ•</div>
            <h2 class="modal__title">{{'contact.error.title' | translate}}</h2>
            <p class="modal__message">
                {{'contact.error.message' | translate}}
            </p>
            <button class="modal__button" (click)="closeModals()">
                {{'contact.error.button' | translate}}
            </button>
        </div>
    </div>
 }
